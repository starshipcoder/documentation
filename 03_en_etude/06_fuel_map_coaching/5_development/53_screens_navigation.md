# FuelMap - Ã‰crans & Navigation

## Vue d'ensemble

| Total Ã©crans | Onboarding | Main | Bottom Sheets |
|--------------|------------|------|---------------|
| 12 | 4 | 2 | 6 |

---

## 1. Flow de Navigation

### 1.1 Arbre de Navigation

```
App Launch
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Splash Screen  â”‚
â”‚     (S01)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  onboardingCompleted?               â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                    â”‚
         â”‚ false              â”‚ true
         â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Onboarding    â”‚    â”‚    Map Page     â”‚
â”‚   (S02-S05)     â”‚    â”‚     (S06)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ completed
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Map Page     â”‚
â”‚     (S06)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 Navigation depuis Map Page

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      MAP PAGE (S06)                      â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ âš™ï¸   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚ Settings     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”˜                              â”‚ Bottom Sheet â”‚  â”‚
â”‚                                        â”‚    (S07)     â”‚  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”‚ ğŸ”½   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚Filterâ”‚                              â”‚ Filters      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”˜                              â”‚ Bottom Sheet â”‚  â”‚
â”‚                                        â”‚    (S08)     â”‚  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”‚Searchâ”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ bar  â”‚                              â”‚ Route Search â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”˜                              â”‚    (S11)     â”‚  â”‚
â”‚                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”                                                â”‚
â”‚  â”‚Markerâ”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ tap  â”‚                              â”‚ Station      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”˜                              â”‚ Bottom Sheet â”‚  â”‚
â”‚                                        â”‚    (S09)     â”‚  â”‚
â”‚                                        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                               â”‚          â”‚
â”‚                                               â–¼          â”‚
â”‚                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚                                        â”‚ Navigation   â”‚  â”‚
â”‚                                        â”‚ externe      â”‚  â”‚
â”‚                                        â”‚    (S10)     â”‚  â”‚
â”‚                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.3 Routes (GoRouter)

```dart
// routes.dart
final routes = [
  GoRoute(
    path: '/',
    name: 'splash',
    builder: (_, __) => const SplashPage(),
  ),
  GoRoute(
    path: '/onboarding',
    name: 'onboarding',
    builder: (_, __) => const OnboardingPage(),
  ),
  GoRoute(
    path: '/map',
    name: 'map',
    builder: (_, __) => const MapPage(),
  ),
];
```

---

## 2. Ã‰crans DÃ©taillÃ©s

---

### S01 - Splash Screen

**Route** : `/`

**DurÃ©e** : 1-2 secondes

**Objectif** : Initialiser l'app et rediriger

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                     â”‚
â”‚                                     â”‚
â”‚                                     â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚            â”‚           â”‚            â”‚
â”‚            â”‚   LOGO    â”‚            â”‚
â”‚            â”‚  FuelMap  â”‚            â”‚
â”‚            â”‚           â”‚            â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                     â”‚
â”‚            â—‹ â—‹ â—‹ (loader)           â”‚
â”‚                                     â”‚
â”‚                                     â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Comportement** :
1. Affiche logo + loader
2. Initialise AppContainer
3. VÃ©rifie `onboardingCompleted` dans SharedPreferences
4. Redirige vers `/onboarding` ou `/map`

**Composants** :
- Logo app (SVG ou PNG)
- CircularProgressIndicator ou Lottie animation

---

### S02 - Onboarding : Bienvenue

**Route** : `/onboarding` (step 1/4)

**Objectif** : Accueillir l'utilisateur

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                     â”‚
â”‚  â†                          Passer  â”‚
â”‚                                     â”‚
â”‚                                     â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚            â”‚           â”‚            â”‚
â”‚            â”‚   â›½ï¸       â”‚            â”‚
â”‚            â”‚  IMAGE    â”‚            â”‚
â”‚            â”‚           â”‚            â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                     â”‚
â”‚         Bienvenue sur               â”‚
â”‚           FuelMap                   â”‚
â”‚                                     â”‚
â”‚    Trouve le carburant le moins     â”‚
â”‚      cher prÃ¨s de chez toi          â”‚
â”‚                                     â”‚
â”‚            â— â—‹ â—‹ â—‹                  â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚        Commencer            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Actions** :
| Ã‰lÃ©ment | Action |
|---------|--------|
| Bouton "Commencer" | â†’ Step 2 (VÃ©hicule) |
| Lien "Passer" | â†’ Map Page (skip all) |

**Analytics** :
- `onboarding_started`

---

### S03 - Onboarding : Type de VÃ©hicule

**Route** : `/onboarding` (step 2/4)

**Objectif** : DÃ©finir le volume du rÃ©servoir

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                     â”‚
â”‚  â†                          Passer  â”‚
â”‚                                     â”‚
â”‚                                     â”‚
â”‚      Quel est ton type de           â”‚
â”‚          vÃ©hicule ?                 â”‚
â”‚                                     â”‚
â”‚   Pour estimer le prix de ton plein â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ğŸš—  Citadine         40L   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ğŸš™  Berline          50L   â”‚ âœ“  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ğŸš  SUV              60L   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ğŸšš  Utilitaire       70L   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                     â”‚
â”‚            â—‹ â— â—‹ â—‹                  â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚         Continuer           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**DonnÃ©es** :

| Type | Volume | Emoji |
|------|--------|-------|
| Citadine | 40L | ğŸš— |
| Berline | 50L | ğŸš™ |
| SUV | 60L | ğŸš |
| Utilitaire | 70L | ğŸšš |

**Actions** :
| Ã‰lÃ©ment | Action |
|---------|--------|
| Option sÃ©lectionnÃ©e | Highlight + checkmark |
| Bouton "Continuer" | Sauvegarde â†’ Step 3 |
| Bouton "â†" | â†’ Step 1 |
| Lien "Passer" | Default (Berline) â†’ Map Page |

**Sauvegarde** : `vehicle_type` + `tank_volume` dans SharedPreferences

---

### S04 - Onboarding : Type de Carburant

**Route** : `/onboarding` (step 3/4)

**Objectif** : DÃ©finir le carburant par dÃ©faut

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                     â”‚
â”‚  â†                          Passer  â”‚
â”‚                                     â”‚
â”‚                                     â”‚
â”‚      Quel carburant utilises-tu     â”‚
â”‚         habituellement ?            â”‚
â”‚                                     â”‚
â”‚      On l'affichera en prioritÃ©     â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚          â”‚  â”‚          â”‚         â”‚
â”‚  â”‚  Diesel  â”‚  â”‚   SP95   â”‚         â”‚
â”‚  â”‚    âœ“     â”‚  â”‚          â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚          â”‚  â”‚          â”‚         â”‚
â”‚  â”‚   SP98   â”‚  â”‚ SP95-E10 â”‚         â”‚
â”‚  â”‚          â”‚  â”‚          â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚          â”‚  â”‚          â”‚         â”‚
â”‚  â”‚   E85    â”‚  â”‚   GPL    â”‚         â”‚
â”‚  â”‚          â”‚  â”‚          â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                     â”‚
â”‚            â—‹ â—‹ â— â—‹                  â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚         Continuer           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**DonnÃ©es** :

| Carburant | Enum | Couleur |
|-----------|------|---------|
| Diesel | `diesel` | Jaune |
| SP95 | `sp95` | Vert |
| SP98 | `sp98` | Vert foncÃ© |
| SP95-E10 | `sp95e10` | Vert clair |
| E85 | `e85` | Bleu |
| GPL | `gpl` | Violet |

**Actions** :
| Ã‰lÃ©ment | Action |
|---------|--------|
| Chip sÃ©lectionnÃ© | Highlight + checkmark |
| Bouton "Continuer" | Sauvegarde â†’ Step 4 |
| Bouton "â†" | â†’ Step 2 |
| Lien "Passer" | Default (Diesel) â†’ Map Page |

**Sauvegarde** : `default_fuel` dans SharedPreferences

---

### S05 - Onboarding : Permission Localisation

**Route** : `/onboarding` (step 4/4)

**Objectif** : Demander la permission GPS

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                     â”‚
â”‚  â†                                  â”‚
â”‚                                     â”‚
â”‚                                     â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚            â”‚           â”‚            â”‚
â”‚            â”‚    ğŸ“     â”‚            â”‚
â”‚            â”‚   MAP     â”‚            â”‚
â”‚            â”‚           â”‚            â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                     â”‚
â”‚     Autorise l'accÃ¨s Ã  ta           â”‚
â”‚         position                    â”‚
â”‚                                     â”‚
â”‚   Pour trouver les stations les     â”‚
â”‚    plus proches de toi              â”‚
â”‚                                     â”‚
â”‚            â—‹ â—‹ â—‹ â—                  â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚     Autoriser la position   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                     â”‚
â”‚        Peut-Ãªtre plus tard          â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Actions** :
| Ã‰lÃ©ment | Action |
|---------|--------|
| Bouton "Autoriser" | `permission_handler.request()` â†’ Map Page |
| Lien "Plus tard" | â†’ Map Page (sans permission) |
| Bouton "â†" | â†’ Step 3 |

**Comportement** :
1. Tap "Autoriser" â†’ Dialog systÃ¨me iOS/Android
2. Si accordÃ© â†’ `onboarding_completed = true` â†’ Map Page
3. Si refusÃ© â†’ Map Page (recherche manuelle possible)

**Analytics** :
- `onboarding_completed` (avec `vehicle_type`, `fuel_type`)
- ou `onboarding_skipped` (avec `step`)

---

### S06 - Map Page (Home)

**Route** : `/map`

**Objectif** : Afficher la carte avec les stations

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ” Rechercher une ville...      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                 âš™ï¸  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”                          â”‚
â”‚    â”‚1.65â‚¬â”‚  Station A               â”‚
â”‚    â”‚ ğŸŸ¢  â”‚                          â”‚
â”‚    â””â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                      â”Œâ”€â”€â”€â”€â”€â”        â”‚
â”‚                      â”‚1.72â‚¬â”‚        â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”      â”‚ ğŸŸ¡  â”‚        â”‚
â”‚         â”‚1.59â‚¬â”‚      â””â”€â”€â”€â”€â”€â”˜        â”‚
â”‚         â”‚ ğŸŸ¢  â”‚                     â”‚
â”‚         â””â”€â”€â”€â”€â”€â”˜         ğŸ“          â”‚
â”‚                      (user)         â”‚
â”‚                                     â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”                          â”‚
â”‚    â”‚1.85â‚¬â”‚                          â”‚
â”‚    â”‚ ğŸ”´  â”‚           â”Œâ”€â”€â”€â”€â”€â”        â”‚
â”‚    â””â”€â”€â”€â”€â”€â”˜           â”‚1.68â‚¬â”‚        â”‚
â”‚                      â”‚ ğŸŸ¡  â”‚        â”‚
â”‚                      â””â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                     â”‚
â”‚                            â”Œâ”€â”€â”€â”    â”‚
â”‚                            â”‚ â— â”‚    â”‚
â”‚                            â””â”€â”€â”€â”˜    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Diesel â–¼  â”‚  Tous â–¼  â”‚  50 stationsâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Composants** :

| Zone | Composant | Description |
|------|-----------|-------------|
| Header | SearchBar | Recherche ville (optionnel) |
| Header | Settings icon | â†’ Settings Bottom Sheet |
| Map | FlutterMap | OpenStreetMap tiles |
| Map | Markers | Stations avec prix |
| Map | User marker | Position GPS |
| Map | FAB | Recentrer sur position |
| Footer | Filter chips | Carburant + FraÃ®cheur |
| Footer | Count | Nombre de stations |

**Marker Station** :

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1.65â‚¬/L     â”‚  â† Prix au litre
â”‚ (~58â‚¬)      â”‚  â† Prix plein estimÃ©
â”‚    ğŸŸ¢       â”‚  â† Indicateur fraÃ®cheur
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| Couleur prix | Condition |
|--------------|-----------|
| ğŸŸ¢ Vert | < moyenne zone - 5% |
| ğŸŸ¡ Orange | Â± 5% moyenne |
| ğŸ”´ Rouge | > moyenne zone + 5% |

| Couleur fraÃ®cheur | Condition |
|-------------------|-----------|
| ğŸŸ¢ Vert | < 24h |
| ğŸŸ¡ Orange | 1-3 jours |
| âš« Gris | > 3 jours |

**Actions** :
| Ã‰lÃ©ment | Action |
|---------|--------|
| Tap marker | â†’ Station Bottom Sheet |
| Tap settings icon | â†’ Settings Bottom Sheet |
| Tap filter chip | â†’ Filters Bottom Sheet |
| Tap FAB | Recentrer carte sur user |
| Pinch/zoom | Zoom carte |
| Pan | DÃ©placer carte |

**Ã‰tats** :

| Ã‰tat | Affichage |
|------|-----------|
| Loading | Skeleton map + spinner |
| Loaded | Carte + markers |
| Error (GPS) | Message + bouton "Autoriser" |
| Error (Network) | Message + bouton "RÃ©essayer" |
| Empty | Message "Aucune station trouvÃ©e" |

---

### S07 - Settings Bottom Sheet

**Trigger** : Tap âš™ï¸ sur Map Page

**Objectif** : Modifier les prÃ©fÃ©rences

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            â”€â”€â”€â”€â”€                    â”‚
â”‚                                     â”‚
â”‚          ParamÃ¨tres                 â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  Type de vÃ©hicule                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Berline (50L)           â–¼  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                     â”‚
â”‚  Carburant par dÃ©faut               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Diesel                  â–¼  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                     â”‚
â”‚  App de navigation                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Apple Plans             â–¼  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  Ã€ propos                        >  â”‚
â”‚  Politique de confidentialitÃ©    >  â”‚
â”‚                                     â”‚
â”‚  Version 1.0.0                      â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Champs** :

| Champ | Type | Options |
|-------|------|---------|
| Type de vÃ©hicule | Dropdown | Citadine, Berline, SUV, Utilitaire |
| Carburant | Dropdown | Diesel, SP95, SP98, SP95-E10, E85, GPL |
| App navigation | Dropdown | Apple Plans, Google Maps |

**Actions** :
| Ã‰lÃ©ment | Action |
|---------|--------|
| Dropdown | Ouvre picker natif |
| Changement valeur | Sauvegarde immÃ©diate SharedPreferences |
| "Ã€ propos" | â†’ Page About (ou URL) |
| "Politique" | â†’ URL privacy policy |
| Swipe down / Tap outside | Ferme bottom sheet |

**Analytics** :
- `preferences_updated` (field, value)

---

### S08 - Filters Bottom Sheet

**Trigger** : Tap sur chips filtres en bas de Map Page

**Objectif** : Filtrer les stations

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            â”€â”€â”€â”€â”€                    â”‚
â”‚                                     â”‚
â”‚           Filtres                   â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  Type de carburant                  â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Diesel â”‚ â”‚  SP95  â”‚ â”‚  SP98  â”‚   â”‚
â”‚  â”‚   âœ“    â”‚ â”‚        â”‚ â”‚        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚SP95-E10â”‚ â”‚  E85   â”‚ â”‚  GPL   â”‚   â”‚
â”‚  â”‚        â”‚ â”‚        â”‚ â”‚        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  Distance max                       â”‚
â”‚  5km â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 50kmâ”‚
â”‚                    10km             â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  Prix max                           â”‚
â”‚  1.00â‚¬ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€ 2.50â‚¬â”‚
â”‚                    Pas de limite    â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  FraÃ®cheur des prix                 â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  < 24h   â”‚ â”‚ < 3 jours â”‚         â”‚
â”‚  â”‚    âœ“     â”‚ â”‚           â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚   Tous   â”‚                       â”‚
â”‚  â”‚          â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚      Appliquer (45)         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Filtres** :

| Filtre | Type | Options | Default |
|--------|------|---------|---------|
| Carburant | Single select | 6 types | PrÃ©fÃ©rence user |
| Distance | Slider | 5km - 50km | 10km |
| Prix max | Slider | 1.00â‚¬ - 2.50â‚¬/L | Pas de limite |
| FraÃ®cheur | Single select | < 24h, < 3j, Tous | Tous |

**Actions** :
| Ã‰lÃ©ment | Action |
|---------|--------|
| Tap chip carburant | SÃ©lectionne (single) |
| Tap chip fraÃ®cheur | SÃ©lectionne (single) |
| Bouton "Appliquer" | Applique filtres + ferme |
| Swipe down | Annule + ferme |

**Comportement** :
- Le nombre entre parenthÃ¨ses "(45)" se met Ã  jour en temps rÃ©el
- Le filtre carburant est sauvegardÃ© dans prÃ©fÃ©rences
- Le filtre fraÃ®cheur n'est pas sauvegardÃ© (reset Ã  chaque session)

**Analytics** :
- `filter_changed` (fuel_type, freshness)

---

### S09 - Station Bottom Sheet

**Trigger** : Tap sur marker station

**Objectif** : Afficher les dÃ©tails d'une station

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            â”€â”€â”€â”€â”€                    â”‚
â”‚                                     â”‚
â”‚  TotalEnergies                      â”‚
â”‚  123 Avenue des Champs-Ã‰lysÃ©es      â”‚
â”‚  75008 Paris                        â”‚
â”‚  ğŸ“ 1.2 km                          â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  Prix des carburants                â”‚
â”‚                                     â”‚
â”‚  Diesel         1.659â‚¬  (~58â‚¬)  ğŸŸ¢  â”‚
â”‚                 il y a 2h           â”‚
â”‚                                     â”‚
â”‚  SP95           1.789â‚¬  (~63â‚¬)  ğŸŸ¡  â”‚
â”‚                 il y a 1j           â”‚
â”‚                                     â”‚
â”‚  SP98           1.859â‚¬  (~65â‚¬)  ğŸŸ¡  â”‚
â”‚                 il y a 1j           â”‚
â”‚                                     â”‚
â”‚  E85            0.899â‚¬  (~31â‚¬)  ğŸŸ¢  â”‚
â”‚                 il y a 3h           â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  Horaires                           â”‚
â”‚  ğŸŸ¢ Ouvert Â· Ferme Ã  22h00          â”‚
â”‚  Lun-Sam: 6h-22h | Dim: 8h-20h      â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  Services                           â”‚
â”‚  ğŸš— Lavage  ğŸª Boutique  ğŸ’³ CB      â”‚
â”‚  ğŸ”§ Gonflage  ğŸ§ DAB                â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚      ğŸ§­ Y aller              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Sections** :

| Section | DonnÃ©es |
|---------|---------|
| Header | Nom, adresse, distance |
| Prix | Liste carburants avec prix, estimation plein, fraÃ®cheur |
| Horaires | Statut (ouvert/fermÃ©), horaires dÃ©taillÃ©s |
| Services | Icons des services disponibles |
| CTA | Bouton navigation |

**Prix ligne** :
```
[Type]    [Prix/L]  ([Prix plein])  [Badge fraÃ®cheur]
          [Temps depuis MAJ]
```

**Services icons** :

| Service | Icon |
|---------|------|
| Lavage auto | ğŸš— |
| Boutique | ğŸª |
| CB acceptÃ©e | ğŸ’³ |
| Gonflage | ğŸ”§ |
| DAB | ğŸ§ |
| Restauration | ğŸ” |
| Toilettes | ğŸš» |
| WiFi | ğŸ“¶ |

**Actions** :
| Ã‰lÃ©ment | Action |
|---------|--------|
| Bouton "Y aller" | â†’ Navigation picker (S10) ou direct |
| Swipe down | Ferme bottom sheet |
| Tap outside | Ferme bottom sheet |

**Analytics** :
- `station_viewed` (station_id, fuel_type, price)

---

### S10 - Navigation Picker (Dialog)

**Trigger** : Tap "Y aller" si plusieurs apps disponibles

**Objectif** : Choisir l'app de navigation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                     â”‚
â”‚       Ouvrir avec                   â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ğŸ—ºï¸  Apple Plans             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ğŸ“ Google Maps             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                     â”‚
â”‚  â˜ Se souvenir de mon choix        â”‚
â”‚                                     â”‚
â”‚           Annuler                   â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Comportement** :
1. Si une seule app installÃ©e â†’ ouvre directement
2. Si prÃ©fÃ©rence sauvegardÃ©e â†’ ouvre directement
3. Sinon â†’ affiche dialog de choix

**Actions** :
| Ã‰lÃ©ment | Action |
|---------|--------|
| Tap option | Ouvre app + (sauvegarde si checkbox) |
| Checkbox | Toggle mÃ©morisation |
| Annuler | Ferme dialog |

**Analytics** :
- `navigation_launched` (station_id, app)

---

## 3. Ã‰tats & Transitions

### 3.1 Matrice des Ã‰tats

| Ã‰cran | Loading | Success | Error | Empty |
|-------|---------|---------|-------|-------|
| Splash | âœ“ | â†’ redirect | - | - |
| Onboarding | - | â†’ next step | - | - |
| Map | Skeleton | Markers | Message + retry | Message |
| Station Sheet | Skeleton | Content | - | - |
| Filters Sheet | - | Content | - | - |
| Settings Sheet | - | Content | - | - |

### 3.2 Gestion Erreurs

| Erreur | Ã‰cran | Message | Action |
|--------|-------|---------|--------|
| GPS refusÃ© | Map | "Position non disponible" | Bouton "ParamÃ¨tres" |
| GPS indisponible | Map | "Impossible d'obtenir la position" | Bouton "RÃ©essayer" |
| Network error | Map | "Connexion impossible" | Bouton "RÃ©essayer" |
| API error | Map | "Erreur de chargement" | Bouton "RÃ©essayer" |
| No stations | Map | "Aucune station dans ce rayon" | Bouton "Ã‰tendre la recherche" |

---

## 4. Animations & Transitions

### 4.1 Transitions de Navigation

| De | Vers | Animation |
|----|------|-----------|
| Splash | Onboarding | Fade |
| Splash | Map | Fade |
| Onboarding steps | Next step | Slide left |
| Onboarding | Map | Fade |

### 4.2 Bottom Sheets

| Action | Animation |
|--------|-----------|
| Ouvrir | Slide up + fade backdrop |
| Fermer | Slide down + fade out backdrop |
| Swipe | Follow finger + rubber band |

### 4.3 Map

| Action | Animation |
|--------|-----------|
| Load markers | Fade in |
| Tap marker | Scale bounce |
| Recentrer | Smooth pan |
| Zoom | Smooth zoom |

---

## 5. Responsive & AccessibilitÃ©

### 5.1 Breakpoints

| Device | Largeur | Adaptation |
|--------|---------|------------|
| iPhone SE | 375px | Bottom sheet 100% height max |
| iPhone 14 | 390px | Standard |
| iPhone 14 Pro Max | 430px | Standard |
| iPad | 768px+ | Bottom sheet 50% width |

### 5.2 AccessibilitÃ©

| Ã‰lÃ©ment | Requirement |
|---------|-------------|
| Markers | Semantic label avec prix |
| Boutons | Min 44x44 tap target |
| Textes | Min 14sp, contraste 4.5:1 |
| Bottom sheets | Focus trap, escape to close |

### 5.3 Dark Mode

Support dark mode natif via `ThemeData`:
- Map tiles : style sombre (si disponible)
- Bottom sheets : fond sombre
- Textes : couleurs adaptÃ©es

---

### S11 - Route Search Bottom Sheet

**Trigger** : Tap sur barre de recherche en haut de Map Page

**Objectif** : Rechercher un trajet pour voir les stations sur la route

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            â”€â”€â”€â”€â”€                    â”‚
â”‚                                     â”‚
â”‚     Rechercher un trajet            â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  DÃ©part                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ğŸ“ Ma position              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                     â”‚
â”‚  ArrivÃ©e                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ğŸ” Entrer une adresse...    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                     â”‚
â”‚  Suggestions rÃ©centes               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ğŸ• Lyon                     â”‚    â”‚
â”‚  â”‚ ğŸ• Marseille                â”‚    â”‚
â”‚  â”‚ ğŸ• Bordeaux                 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚    ğŸ” Rechercher stations   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Composants** :

| Zone | Composant | Description |
|------|-----------|-------------|
| DÃ©part | TextField + icon | Position actuelle par dÃ©faut, modifiable |
| ArrivÃ©e | TextField + icon | Autocomplete adresses |
| Suggestions | Liste | Recherches rÃ©centes |
| CTA | Bouton | Lance la recherche |

**Actions** :

| Ã‰lÃ©ment | Action |
|---------|--------|
| Champ DÃ©part | Ouvre autocomplete |
| Champ ArrivÃ©e | Ouvre autocomplete |
| Suggestion | Remplit le champ ArrivÃ©e |
| Bouton "Rechercher" | Ferme sheet â†’ affiche route + stations |
| Swipe down | Annule |

**Autocomplete** :
- Utilise API de geocoding (ex: Nominatim OSM, ou autre)
- Affiche suggestions au fur et Ã  mesure de la saisie
- Stocke les 5 derniÃ¨res recherches en local

**Analytics** :
- `route_search_started`
- `route_search_completed` (origin, destination)

---

### S12 - Route Results (Overlay Carte)

**Trigger** : AprÃ¨s recherche de trajet validÃ©e

**Objectif** : Afficher les stations le long du trajet

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Paris â†’ Lyon           âœ• Fermer â”‚ â”‚
â”‚ â”‚ 465 km Â· 12 stations            â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚    A â”€â”€â”€â”€â—â”€â”€â”€â”€â—â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€ B  â”‚
â”‚         â”‚    â”‚    â”‚        â”‚        â”‚
â”‚       â”Œâ”€â”´â”€â”â”Œâ”€â”´â”€â”â”Œâ”€â”´â”€â”    â”Œâ”€â”´â”€â”      â”‚
â”‚       â”‚1.59â”‚1.62â”‚1.65â”‚    â”‚1.58â”‚     â”‚
â”‚       â”‚ ğŸŸ¢ â”‚ ğŸŸ¡ â”‚ ğŸŸ¡ â”‚    â”‚ ğŸŸ¢ â”‚     â”‚
â”‚       â””â”€â”€â”€â”˜â””â”€â”€â”€â”˜â””â”€â”€â”€â”˜    â””â”€â”€â”€â”˜      â”‚
â”‚                                     â”‚
â”‚         Route affichÃ©e en bleu      â”‚
â”‚         sur la carte                â”‚
â”‚                                     â”‚
â”‚                            â”Œâ”€â”€â”€â”    â”‚
â”‚                            â”‚ â— â”‚    â”‚
â”‚                            â””â”€â”€â”€â”˜    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Trier: Prix â–¼ â”‚ Distance â–¼        â”‚
â”‚                                     â”‚
â”‚  12 stations sur votre trajet       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Comportement** :
1. Trace la route sur la carte (polyline bleue)
2. Affiche uniquement les stations Ã  moins de X km de la route
3. Zoom auto pour voir tout le trajet
4. Header sticky avec infos trajet

**Markers en mode Route** :

Chaque marker affiche :
- Prix/L + estimation plein
- Couleur selon prix (vert/orange/rouge)
- Badge fraÃ®cheur

**Station Bottom Sheet en mode Route** (S09 modifiÃ©) :

Ajoute des infos supplÃ©mentaires :
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            â”€â”€â”€â”€â”€                    â”‚
â”‚                                     â”‚
â”‚  TotalEnergies                      â”‚
â”‚  123 Rue Example, 69000 Lyon        â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ğŸ“ Sur votre trajet         â”‚    â”‚
â”‚  â”‚    +2 km de dÃ©tour          â”‚    â”‚
â”‚  â”‚    +3 min de trajet         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                     â”‚
â”‚  ... (reste du bottom sheet)        â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Infos trajet par station** :

| Info | Description |
|------|-------------|
| Distance au trajet | "Sur votre trajet" ou "Ã€ 500m du trajet" |
| DÃ©tour | "+2 km de dÃ©tour" (aller-retour depuis route) |
| Temps dÃ©tour | "+3 min" (estimation) |
| Position | "Ã€ 120 km du dÃ©part" (distance depuis origine) |

**Tri des stations** :

| Option | Description |
|--------|-------------|
| Prix | Du moins cher au plus cher |
| Distance | Du plus proche au plus loin (depuis dÃ©part) |
| DÃ©tour | Du plus petit dÃ©tour au plus grand |

**Actions** :

| Ã‰lÃ©ment | Action |
|---------|--------|
| Bouton "âœ• Fermer" | Quitte mode route â†’ retour carte normale |
| Tap marker | Ouvre Station Bottom Sheet (avec infos dÃ©tour) |
| Tri | Change l'ordre des stations |
| Bouton "Y aller" | Navigation vers station (inclut le dÃ©tour) |

**Analytics** :
- `route_station_viewed` (station_id, detour_km, detour_min)
- `route_navigation_launched` (station_id)

---

## 6. Checklist Ã‰crans

### Onboarding
- [ ] S01 - Splash Screen
- [ ] S02 - Bienvenue
- [ ] S03 - Type vÃ©hicule
- [ ] S04 - Type carburant
- [ ] S05 - Permission GPS

### Main
- [ ] S06 - Map Page
- [ ] S07 - Settings Bottom Sheet
- [ ] S08 - Filters Bottom Sheet
- [ ] S09 - Station Bottom Sheet
- [ ] S10 - Navigation Picker
- [ ] S11 - Route Search Bottom Sheet
- [ ] S12 - Route Results (overlay carte)

---

**Document validÃ© le** : 29/11/2025
**Version** : 1.1
